<?xml version="1.0" encoding="UTF-8" ?>

<config>

    <luceneMatchVersion>5.2</luceneMatchVersion>

    <abortOnConfigurationError>${solr.abortOnConfigurationError:true}</abortOnConfigurationError>

    <lib dir="${solr.install.dir:../../..}/contrib/extraction/lib" />
    <lib dir="${solr.install.dir:../../..}/dist" regex="solr-cell-\d.*\.jar" />
    <lib dir="${solr.install.dir:../../..}/dist" regex="solr-dataimporthandler-\d.*\.jar" />

    <indexConfig>
        <useCompoundFile>false</useCompoundFile>

        <mergeFactor>10</mergeFactor>

        <ramBufferSizeMB>32</ramBufferSizeMB>

        <maxFieldLength>2147483647</maxFieldLength>

        <writeLockTimeout>1000</writeLockTimeout>

        <lockType>native</lockType>

        <reopenReaders>true</reopenReaders>

        <deletionPolicy class="solr.SolrDeletionPolicy">
            <str name="maxCommitsToKeep">1</str>
            <str name="maxOptimizedCommitsToKeep">0</str>
        </deletionPolicy>

        <infoStream file="INFOSTREAM.txt">false</infoStream>
    </indexConfig>

    <updateHandler class="solr.DirectUpdateHandler2">
    </updateHandler>

    <query>
        <maxBooleanClauses>1024</maxBooleanClauses>

        <filterCache class="solr.FastLRUCache" size="512" initialSize="512" autowarmCount="0"/>

        <queryResultCache class="solr.LRUCache" size="512" initialSize="512" autowarmCount="0"/>

        <documentCache class="solr.LRUCache" size="512" initialSize="512" autowarmCount="0"/>

        <enableLazyFieldLoading>true</enableLazyFieldLoading>

        <queryResultWindowSize>20</queryResultWindowSize>

        <queryResultMaxDocsCached>200</queryResultMaxDocsCached>

        <listener event="newSearcher" class="solr.QuerySenderListener">
            <arr name="queries">
            </arr>
        </listener>

        <listener event="firstSearcher" class="solr.QuerySenderListener">
            <arr name="queries">
            </arr>
        </listener>

        <useColdSearcher>false</useColdSearcher>

        <maxWarmingSearchers>2</maxWarmingSearchers>
    </query>

    <requestDispatcher handleSelect="true" >
        <httpCaching lastModifiedFrom="openTime" etagSeed="Solr">
        </httpCaching>
    </requestDispatcher>

    <requestHandler name="standard" class="solr.SearchHandler" default="true">
        <lst name="defaults">
            <str name="echoParams">explicit</str>
        </lst>
    </requestHandler>

    <searchComponent name="spellcheck" class="solr.SpellCheckComponent">

        <str name="queryAnalyzerFieldType">textSpell</str>

        <lst name="spellchecker">
            <str name="name">default</str>
            <str name="field">name</str>
            <str name="spellcheckIndexDir">./spellchecker</str>
        </lst>

    </searchComponent>

    <!-- A request handler utilizing the spellcheck component.
    #############################################################################
    NOTE: This is purely as an example.  The whole purpose of the
    SpellCheckComponent is to hook it into the request handler that handles (i.e.
    the standard or dismax SearchHandler) queries such that a separate request is
    not needed to get suggestions.

    IN OTHER WORDS, THERE IS REALLY GOOD CHANCE THE SETUP BELOW IS NOT WHAT YOU
    WANT FOR YOUR PRODUCTION SYSTEM!
    #############################################################################
    -->
    <requestHandler name="/spell" class="solr.SearchHandler" lazy="true">
        <lst name="defaults">
            <!-- omp = Only More Popular -->
            <str name="spellcheck.onlyMorePopular">false</str>
            <!-- exr = Extended Results -->
            <str name="spellcheck.extendedResults">false</str>
            <!--  The number of suggestions to return -->
            <str name="spellcheck.count">1</str>
        </lst>
        <arr name="last-components">
            <str>spellcheck</str>
        </arr>
    </requestHandler>

    <requestHandler name="/update/extract" class="org.apache.solr.handler.extraction.ExtractingRequestHandler" startup="lazy">
        <lst name="defaults">
            <str name="fmap.content">text</str>
            <str name="lowernames">true</str>
            <str name="uprefix">ignored_</str>

            <str name="captureAttr">true</str>
            <str name="fmap.a">links</str>
            <str name="fmap.div">ignored_</str>
        </lst>
    </requestHandler>

    <requestHandler name="/update" class="solr.UpdateRequestHandler" />

    <requestHandler name="/analysis/document" class="solr.DocumentAnalysisRequestHandler" />

    <requestHandler name="/analysis/field" class="solr.FieldAnalysisRequestHandler" />

    <requestHandler name="/admin/ping" class="PingRequestHandler">
        <lst name="defaults">
            <str name="qt">standard</str>
            <str name="q">solrpingquery</str>
            <str name="echoParams">all</str>
        </lst>
    </requestHandler>

    <requestHandler name="/debug/dump" class="solr.DumpRequestHandler" >
        <lst name="defaults">
            <str name="echoParams">explicit</str>
            <str name="echoHandler">true</str>
        </lst>
    </requestHandler>

    <highlighting>
        <fragmenter name="gap" class="org.apache.solr.highlight.GapFragmenter" default="true">
            <lst name="defaults">
                <int name="hl.fragsize">100</int>
            </lst>
        </fragmenter>

        <fragmenter name="regex" class="org.apache.solr.highlight.RegexFragmenter">
            <lst name="defaults">
                <int name="hl.fragsize">70</int>
                <float name="hl.regex.slop">0.5</float>
                <str name="hl.regex.pattern">[-\w ,/\n\"']{20,200}</str>
            </lst>
        </fragmenter>

        <formatter name="html" class="org.apache.solr.highlight.HtmlFormatter" default="true">
            <lst name="defaults">
                <str name="hl.simple.pre"><![CDATA[<em>]]></str>
                <str name="hl.simple.post"><![CDATA[</em>]]></str>
            </lst>
        </formatter>
    </highlighting>

    <admin>
        <defaultQuery>solr</defaultQuery>
    </admin>

</config>
