<?xml version="1.0" encoding="UTF-8" ?>

<config>

    <luceneMatchVersion>5.2</luceneMatchVersion>

    <lib dir="${solr.install.dir:../../..}/contrib/extraction/lib" />
    <lib dir="${solr.install.dir:../../..}/dist" regex="solr-cell-\d.*\.jar" />
    <lib dir="${solr.install.dir:../../..}/dist" regex="solr-dataimporthandler-\d.*\.jar" />

    <indexConfig>
        <!-- TODO Current default is 100. -->
        <ramBufferSizeMB>32</ramBufferSizeMB>

        <!-- TODO not found in documentation -->
        <maxFieldLength>2147483647</maxFieldLength>

        <!-- Set to true for more detailed debug information from the indexing process as Solr log messages. -->
        <infoStream>false</infoStream>
    </indexConfig>

    <!-- TODO no options configured - Anything needed? -->
    <updateHandler class="solr.DirectUpdateHandler2">
    </updateHandler>

    <query>
        <maxBooleanClauses>1024</maxBooleanClauses>

        <filterCache class="solr.FastLRUCache" size="512" initialSize="512" autowarmCount="0"/>

        <queryResultCache class="solr.LRUCache" size="512" initialSize="512" autowarmCount="0"/>

        <documentCache class="solr.LRUCache" size="512" initialSize="512" autowarmCount="0"/>

        <enableLazyFieldLoading>true</enableLazyFieldLoading>

        <queryResultWindowSize>20</queryResultWindowSize>

        <queryResultMaxDocsCached>200</queryResultMaxDocsCached>

        <listener event="newSearcher" class="solr.QuerySenderListener">
            <arr name="queries">
            </arr>
        </listener>

        <listener event="firstSearcher" class="solr.QuerySenderListener">
            <arr name="queries">
            </arr>
        </listener>

        <useColdSearcher>false</useColdSearcher>

        <maxWarmingSearchers>2</maxWarmingSearchers>
    </query>

    <requestDispatcher handleSelect="true" >
        <httpCaching lastModifiedFrom="openTime" etagSeed="Solr">
        </httpCaching>
    </requestDispatcher>

    <requestHandler name="standard" class="solr.SearchHandler" default="true">
        <lst name="defaults">
            <str name="echoParams">explicit</str>
        </lst>
    </requestHandler>

    <!--
        Configuration for search term suggestions.
    -->

    <!-- Provides suggestions based on other, similar terms. -->
    <searchComponent name="spellcheck" class="solr.SpellCheckComponent">

        <str name="queryAnalyzerFieldType">textSpell</str>

        <lst name="spellchecker">
            <str name="name">default</str>
            <str name="field">text</str>
            <str name="spellcheckIndexDir">./spellchecker</str>
        </lst>

    </searchComponent>

    <!-- TODO not what we need? definitely not working yet - need suggestions for search terms -->
    <requestHandler name="/spell" class="solr.SearchHandler" lazy="true">
        <lst name="defaults">
            <str name="spellcheck.dictionary">default</str>
            <str name="spellcheck.extendedResults">true</str>
            <str name="spellcheck.count">20</str>
        </lst>
        <arr name="last-components">
            <str>spellcheck</str>
        </arr>
    </requestHandler>

    <requestHandler name="/update/extract" class="org.apache.solr.handler.extraction.ExtractingRequestHandler"
                    startup="lazy">
        <lst name="defaults">
            <str name="fmap.content">text</str>
            <str name="lowernames">true</str>
            <str name="uprefix">ignored_</str>

            <str name="captureAttr">true</str>
            <str name="fmap.a">links</str>
            <str name="fmap.div">ignored_</str>
        </lst>
    </requestHandler>

    <requestHandler name="/update" class="solr.UpdateRequestHandler" />

    <!--
        Request handlers for analysis.
    -->
    <requestHandler name="/analysis/document" class="solr.DocumentAnalysisRequestHandler" startup="lazy" />

    <requestHandler name="/analysis/field" class="solr.FieldAnalysisRequestHandler" startup="lazy" />

    <!-- Handler for checking health of Solr core. -->
    <requestHandler name="/admin/ping" class="PingRequestHandler">
        <lst name="defaults">
            <str name="qt">standard</str>
            <str name="q">solrpingquery</str>
            <str name="echoParams">all</str>
        </lst>
    </requestHandler>

    <!-- Echo the request content back to the client. -->
    <requestHandler name="/debug/dump" class="solr.DumpRequestHandler" >
        <lst name="defaults">
            <str name="echoParams">explicit</str>
            <str name="echoHandler">true</str>
        </lst>
    </requestHandler>

</config>
